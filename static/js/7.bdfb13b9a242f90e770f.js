webpackJsonp([7],{"5+RJ":function(e,t,i){"use strict";function s(e){i("J3t2")}Object.defineProperty(t,"__esModule",{value:!0});var a=i("bGai"),l=i("X2Oc"),n={editPage:!0,width:1200,labelWidth:70,title:"角色",dynamic:[[{name:"id",hidden:!0},{name:"name",type:"text",span:24,label:"角色名",rules:{required:!0}},{name:"description",type:"editor",textarea:{minRows:2,maxRows:3},span:24,label:"角色描述"},{name:"status",openText:"启用",closeText:"禁用",type:"switch",span:24,label:"角色状态",value:1,trueValue:1,falseValue:0,rules:{required:!0,type:"number"}}]]},o={dataUrl:"/sys/role/list"},r={selection:[],pageSize:20,labelWidth:70,title:"角色管理",permsPrefix:"role",editOptions:n,dataUrl:"/sys/role/list",createUrl:"/sys/role/create",deleteUrl:"/sys/role/delete",updateUrl:"/sys/role/update",param:{},columns:[{type:"selection",width:60,align:"center"},{key:"name",title:"角色名",align:"center",width:180},{key:"status",title:"角色状态",align:"center",width:180,enum:[{value:"启用",id:1},{value:"禁用",id:0}]},{key:"description",title:"角色描述",align:"center"}],searchDynamic:[[{name:"name",type:"text",span:6,label:"角色名"},{name:"description",label:"角色描述",span:6,type:"text"},{name:"status",label:"角色状态",span:6,type:"select",data:[{label:"启用",value:1},{label:"禁用",value:0}]}]]},d={data:function(){return{tableOptions:r,treeOptions:o,editVisible:!1,editLoading:!0,resIds:[]}},computed:{isSingle:function(){return!(null!=this.tableOptions.selection&&1===this.tableOptions.selection.length)}},methods:{treeLoaded:function(e,t){for(var i=0;i<e.length;i++)2!==e[i].resType&&l.a.isNotChilden(e,e[i].id)||null==t.data.selected||!t.data.selected.contains(e[i].id)||(console.log(e[i]),this.$set(e[i],"checked",!0))},roleResEdit:function(){var e=this.$refs.crudView.getSelection();null!=e&&(this.$refs.resTree.queryData({roleId:e[0].id}),this.editVisible=!0)},roleResEditOk:function(){for(var e=this,t=this.$refs.crudView.getSelection(),i=this.$refs.resTree.getCheckedNodes(!0),s=[],a=0;a<i.length;a++)s.push(i[a].id);var l={ids:s.toString(),roleId:t[0].id};this.$http.apiPost("/sys/roleRes/saveRes",l).then(function(t){e.editLoading=!1,t.success?(e.$Message.success("提交成功"),e.editVisible=!1):(e.$http.handleError(t),setTimeout(function(){e.editLoading=!0},100))})}},mounted:function(){},components:{CrudView:a.d,DataTree:a.g}},c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("CrudView",{ref:"crudView",attrs:{tableOptions:e.tableOptions}},[i("template",{slot:"toolbar"},[i("Modal",{attrs:{title:"角色资源","class-name":"vertical-center-modal",width:"400",loading:e.editLoading},on:{"on-ok":e.roleResEditOk},model:{value:e.editVisible,callback:function(t){e.editVisible=t},expression:"editVisible"}},[i("DataTree",{ref:"resTree",staticStyle:{height:"400px",overflow:"auto"},attrs:{dataUrl:"/sys/roleRes/getRoleRes","show-checkbox":"",lazy:""},on:{"on-data-loaded":e.treeLoaded},model:{value:e.resIds,callback:function(t){e.resIds=t},expression:"resIds"}})],1),e._v(" "),i("i-button",{attrs:{type:"ghost",shape:"circle",icon:"ios-list-outline",disabled:e.isSingle},on:{click:function(t){e.roleResEdit()}}},[e._v("角色资源\n    ")])],1)],2)},u=[],p={render:c,staticRenderFns:u},h=p,f=i("VU/8"),b=s,m=f(d,h,!1,b,"data-v-bf1af1c6",null);t.default=m.exports},HkI5:function(e,t,i){t=e.exports=i("FZ+f")(!1),t.push([e.i,".sd[data-v-bf1af1c6]{display:block}",""])},J3t2:function(e,t,i){var s=i("HkI5");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i("rjj0")("2ce85248",s,!0,{})}});